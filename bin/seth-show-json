#!/usr/bin/env bash
is-short-hexnum() { [[ ${#2} -lt $1 && $2 =~ 0x[[:xdigit:]]+ ]]; }
show-hexnum() { digits=${1:2}; bc <<<"ibase=16; ${digits^^}"; }
show-json() if [[ $1 = \"*\" ]]; then
  unquoted=`jshon <<<"[$1]" -a -u`
  if is-short-hexnum 20 "$unquoted"; then
    show-hexnum "$unquoted"
  else
    echo "$unquoted"
  fi
else
  echo "$1"
fi

case $1 in
  \"*\") show-json "$1";;
  \[*\]) jshon <<<"$1" -a -j | show-json;;
  \{*\}) jshon <<<"$1" -k |
    while read -r key; do
      value=`jshon <<<"$1" -e "$key" -j`
      printf "%-23s %s\n" "$key" "$(show-json "$value")"
    done;;
  *) echo "$1";;
esac

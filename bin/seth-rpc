#!/usr/bin/env bash
set -e
jsonrpc2-result() { jshon -Q -e result -j; }
jsonrpc2-error()  { jshon -Q -e error -j; }

request=`seth jsonrpc2-req -- "$@"`
response=`seth rpc-curl <<<"$request"`

if result=`jsonrpc2-result <<<"$response"`; then
  seth show-json "$result"
elif error=`jsonrpc2-error <<<"$response"`; then
  seth show-json >&2 "$error"
  exit 1
else
  echo >&2 "$response"
  exit 1
fi

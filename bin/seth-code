#!/usr/bin/env bash
### seth-code -- print the bytecode of a contract account
### Usage: seth code [<options>] <address>
###
### Options:
###
###   -b, --block=NUMBER        block number (or latest/earliest/pending)
###
set -e
wrong-usage() { seth help ${0##*/seth-}; exit 1; }

optspec=(-o b: -l block:)
options=$(getopt -n $(basename $0) "${optspec[@]}" -- "$@") || wrong-usage
eval set -- $options; while [[ $1 ]]; do
  case $1 in
    --)            shift; break;;
    -b|--block)    shift; block=$1;;
  esac; shift
done

[[ $# = 1 ]] || wrong-usage
[[ -z $block || $block = 0x* ]] || wrong-usage

seth --rpc eth_getCode $1 $block
